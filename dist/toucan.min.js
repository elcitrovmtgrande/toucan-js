"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toucan=void 0;const jsonwebtoken_1=__importDefault(require("jsonwebtoken")),jwt_decode_1=__importDefault(require("jwt-decode"));class Toucan{constructor(t,e){this.token="",this.data={iat:-1,exp:0},this.is_jwt=!1,this.is_valid=!1,this.default_secret="We love Toucan !",this.default_expiresIn=3600,this.value=t,this.config=e,this._init()}isAuthentic(){var t;try{if("string"==typeof this.token){return"object"==typeof jsonwebtoken_1.default.verify(this.token,(null===(t=this.config)||void 0===t?void 0:t.secret)||this.default_secret)}return!1}catch(t){return!1}}isJWT(){return this.is_jwt}isValid(){var t;return(null===(t=this.data)||void 0===t?void 0:t.exp)&&this.data.exp>this._10((new Date).getTime())?(this.is_valid=!0,this.is_valid):(this.is_valid=!1,this.is_valid)}isExpired(){var t;return(null===(t=this.data)||void 0===t?void 0:t.exp)&&this.data.exp>this._10((new Date).getTime())?(this.is_valid=!0,!this.is_valid):(this.is_valid=!1,!this.is_valid)}getInput(){return this.value}getConfig(){return this.config}getToken(){return this.token}getPayload(){return this.data}_init(){var t,e,i;const s=`[${(new Date).toJSON()}:Toucan] >>> Oh no ! Toucan can only read real tokens... (provided value: ${this.value})`;if("string"==typeof this.value)try{const e=(0,jwt_decode_1.default)(this.value);e&&"object"==typeof e&&(this.data=e,this.token=this.value,this.is_jwt=!0,(null===(t=this.data)||void 0===t?void 0:t.exp)&&this.data.exp>this._10((new Date).getTime())&&(this.is_valid=!0))}catch(t){throw console.log(s),new Error(s)}else{if("object"!=typeof this.value){(new Date).toJSON(),this.value;throw console.log(s),new Error(s)}{const t=jsonwebtoken_1.default.sign(this.value,(null===(e=this.config)||void 0===e?void 0:e.secret)||this.default_secret,{expiresIn:(null===(i=this.config)||void 0===i?void 0:i.expiresIn)||this.default_expiresIn}),s=(0,jwt_decode_1.default)(t);this.token=t,this.data=s,this.is_jwt=!0}}}_10(t){const e=t.toString().slice(0,10);return parseInt(e,10)}}exports.Toucan=Toucan,exports.default=Toucan;