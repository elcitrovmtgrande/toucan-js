"use strict";var __importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Toucan=void 0;const jsonwebtoken_1=__importDefault(require("jsonwebtoken")),jwt_decode_1=__importDefault(require("jwt-decode"));class Toucan{constructor(t,i){this.token="",this.data={iat:-1,exp:0},this.is_jwt=!1,this.is_valid=!1,this.value=t,this.config=i,this._init()}isAuthentic(){var t;try{if("string"==typeof this.value){return"object"==typeof jsonwebtoken_1.default.verify(this.value,(null===(t=this.config)||void 0===t?void 0:t.secret)||"We love Toucan !")}return!1}catch(t){return!1}}isJWT(){return this.is_jwt}isValid(){var t;return(null===(t=this.data)||void 0===t?void 0:t.exp)>this._10((new Date).getTime())?(this.is_valid=!0,this.is_valid):(this.is_valid=!1,this.is_valid)}isExpired(){var t;return(null===(t=this.data)||void 0===t?void 0:t.exp)>this._10((new Date).getTime())?(this.is_valid=!0,!this.is_valid):(this.is_valid=!1,!this.is_valid)}getInput(){return this.value}getConfig(){return this.config}getToken(){return this.token}getPayload(){return this.data}_init(){var t,i,e;if("string"==typeof this.value)try{const i=(0,jwt_decode_1.default)(this.value);i&&"object"==typeof i&&(this.data=i,this.token=this.value,this.is_jwt=!0,(null===(t=this.data)||void 0===t?void 0:t.exp)>this._10((new Date).getTime())&&(this.is_valid=!0))}catch(t){console.log(`[${(new Date).toJSON()}:Toucan] >>> Oh no ! Toucan can only read real tokens... (provided value: ${this.value})`)}"object"==typeof this.value&&(this.token=jsonwebtoken_1.default.sign(this.value,(null===(i=this.config)||void 0===i?void 0:i.secret)||"We love Toucan !",{expiresIn:(null===(e=this.config)||void 0===e?void 0:e.expiresIn)||3600}),this.data=this.value,this.is_jwt=!0)}_10(t){const i=t.toString().slice(0,10);return parseInt(i,10)}}exports.Toucan=Toucan,exports.default=Toucan;